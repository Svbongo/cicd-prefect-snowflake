CREATE OR REPLACE TABLE DEMO_DB.DATA_PIPELINE.SALARY_HISTORY (
    ENTRY_ID NUMBER(38,0) NOT NULL,
    EMPLOYEE_ID NUMBER(38,0),
    CHANGE_DATE DATE,
    OLD_SALARY NUMBER(18,2),
    NEW_SALARY NUMBER(18,2),
    PRIMARY KEY (ENTRY_ID),
    FOREIGN KEY (EMPLOYEE_ID) REFERENCES DEMO_DB.DATA_PIPELINE.EMPLOYEES(EMPLOYEE_ID)
);

INSERT INTO DEMO_DB.DATA_PIPELINE.SALARY_HISTORY 
(ENTRY_ID, EMPLOYEE_ID, CHANGE_DATE, OLD_SALARY, NEW_SALARY) 
VALUES 
(1, 101, TO_DATE('2022-01-01', 'YYYY-MM-DD'), 85000.00, 90000.00),
(2, 101, TO_DATE('2023-01-01', 'YYYY-MM-DD'), 90000.00, 95000.00),
(3, 102, TO_DATE('2022-03-10', 'YYYY-MM-DD'), 68000.00, 70000.00),
(4, 103, TO_DATE('2020-07-23', 'YYYY-MM-DD'), 60000.00, 65000.00),
(5, 104, TO_DATE('2019-11-01', 'YYYY-MM-DD'), 70000.00, 72000.00);
