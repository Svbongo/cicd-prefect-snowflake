CREATE OR REPLACE TABLE DEMO_DB.DATA_PIPELINE.SALARY_HISTORY (
  ENTRY_ID NUMBER(38,0) NOT NULL,
  EMPLOYEE_ID NUMBER(38,0),
  CHANGE_DATE DATE,
  OLD_SALARY NUMBER(18,2),
  NEW_SALARY NUMBER(18,2),
  PRIMARY KEY (ENTRY_ID),
  FOREIGN KEY (EMPLOYEE_ID) REFERENCES DEMO_DB.DATA_PIPELINE.EMPLOYEES(EMPLOYEE_ID)
);


INSERT INTO DEMO_DB.DATA_PIPELINE.SALARY_HISTORY (EMPLOYEE_ID, SALARY_AMOUNT, EFFECTIVE_DATE) VALUES
  (101, 90000.00, TO_DATE('2022-01-01', 'YYYY-MM-DD')),
  (101, 95000.00, TO_DATE('2023-01-01', 'YYYY-MM-DD')),
  (102, 70000.00, TO_DATE('2022-03-10', 'YYYY-MM-DD')),
  (103, 65000.00, TO_DATE('2020-07-23', 'YYYY-MM-DD')),
  (104, 72000.00, TO_DATE('2019-11-01', 'YYYY-MM-DD'));

